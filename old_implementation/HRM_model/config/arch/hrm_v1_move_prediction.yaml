name: hrm.hrm_act_v1@HierarchicalReasoningModel_ACTV1
loss:
  name: losses@ACTLossHead
  loss_type: stablemax_cross_entropy
  move_loss_weight: 2.0  # Higher weight for move prediction

halt_exploration_prob: 0.1
halt_max_steps: 8  # Shorter reasoning for move prediction

H_cycles: 3  # More high-level strategic thinking
L_cycles: 2  # Fast tactical calculations

H_layers: 4
L_layers: 4

hidden_size: 512
num_heads: 8
expansion: 4

puzzle_emb_ndim: ${.hidden_size}

pos_encodings: rope

# Move prediction configuration
use_move_prediction: true   # Enable move prediction mode
num_actions: 64            # Example: Chess has ~64 squares (will need to adjust per game)
move_prediction_from_token: 0  # Use first token after puzzle embedding for move prediction

# Chess-specific example (uncomment and adjust for chess):
# num_actions: 4096  # Approximate upper bound for chess moves (from_square * to_square * promotion)